<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>عقد زواج يوسف &amp; روان — لحظة الأبد</title>
  <style>
    :root{--press-sec:15}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family: 'Noto Kufi Arabic', 'Cairo', Tahoma, system-ui, -apple-system;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 10% 10%, #fff7f8, #ffdfe6 12%, #ffc1d3 40%, #ff8fb2 100%);color:#421b2a}

    .stage{width:96%;max-width:1100px;background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));border-radius:22px;padding:28px;box-shadow:0 16px 50px rgba(0,0,0,0.18);text-align:center}
    h1{margin:0 0 6px;font-size:30px;color:#fff;text-shadow:0 8px 30px rgba(0,0,0,0.18)}
    p.lead{margin:4px 0 22px;color:rgba(255,255,255,0.95)}

    .fingers{display:flex;gap:30px;justify-content:center;flex-wrap:wrap}
    .finger-card{width:230px}
    .finger{width:230px;height:230px;border-radius:50%;background:linear-gradient(180deg,#ffffff,#ffeef6);display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 18px 40px rgba(0,0,0,0.18);cursor:pointer;user-select:none}
    .finger svg{width:120px;height:120px;opacity:0.96;pointer-events:none}
    .count{position:absolute;bottom:12px;left:50%;transform:translateX(-50%);background:rgba(66,27,42,0.14);padding:6px 12px;border-radius:18px;color:#fff;font-weight:800}
    .name{margin-top:12px;font-size:20px;color:#fff;font-weight:900;min-height:28px;text-shadow:0 4px 14px rgba(0,0,0,0.22)}
    .status{margin-top:6px;color:rgba(255,255,255,0.95)}

    .ring{transform:rotate(-90deg)}
    .finger.pressing{transform:scale(0.985);box-shadow:inset 0 10px 30px rgba(0,0,0,0.08)}

    /* Romance scene */
    .scene{margin-top:28px;min-height:260px;position:relative;overflow:hidden;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.02));padding:18px}

    .character{position:absolute;bottom:18px;width:220px;height:220px;display:flex;align-items:flex-end;justify-content:center;transition:transform 900ms cubic-bezier(.2,.9,.3,1);opacity:0}
    .groom{left:-260px}
    .bride{right:-260px}
    .character.show{opacity:1}

    /* simple SVG silhouettes centered inside */
    .avatar{width:140px;height:160px}

    .hands{position:absolute;bottom:56px;left:50%;transform:translateX(50%);opacity:0;transition:opacity 700ms 200ms ease}
    .hands.show{opacity:1}

    .banner{position:absolute;top:22px;left:50%;transform:translateX(-50%) scale(0.95);background:linear-gradient(90deg,#fff6fb,#ffeef6);padding:12px 22px;border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,0.14);display:none}
    .banner.show{display:flex;align-items:center;gap:12px}
    .banner strong{color:#b42f58;font-size:20px}

    .controls{margin-top:18px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
    button{padding:10px 16px;border-radius:10px;border:none;background:rgba(255,255,255,0.12);color:#fff;font-weight:800;cursor:pointer}
    .primary{background:linear-gradient(90deg,#ff6b8a,#ff4471);box-shadow:0 8px 30px rgba(255,77,109,0.14)}

    .hearts{position:absolute;left:0;right:0;top:0;pointer-events:none}
    .heart{position:absolute;font-size:22px;opacity:0;animation:rise 2.6s linear forwards}
    @keyframes rise{0%{transform:translateY(0) scale(0.6);opacity:1}100%{transform:translateY(-240px) translateX(var(--tx,0)) scale(1);opacity:0}}

    .small{margin-top:10px;color:rgba(255,255,255,0.9)}

    @media(max-width:720px){.finger{width:170px;height:170px}.finger-card{width:170px}.character{width:150px;height:150px}.avatar{width:110px;height:120px}}
  </style>
</head>
<body>
  <main class="stage" role="main" aria-label="بصمات الحب">
    <h1>💍 بصمات يوسف &amp; روان — لحظة الأبد</h1>
    <p class="lead">اضغط مطوّلًا على بصمتك لـ <strong>15 ثانية</strong> كاملة بدون رفع — بعد ما تنتها الاتنين، هتشوف مراحل رومانسية كأنها فيلم صغير.</p>

    <section class="fingers" aria-hidden="false">
      <div class="finger-card">
        <div class="finger" tabindex="0" role="button" aria-pressed="false" data-person="youssef" aria-label="بصمة يوسف">
          <!-- fingerprint icon -->
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <g fill="none" stroke="#b32f52" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <path d="M50 20c0 0-8 0-12 8-5 11-6 22-6 30 0 14 6 28 20 28s20-14 20-28c0-8-1-19-6-30-4-8-12-8-12-8" />
              <path d="M45 18c0 0-5 0-8 6-4 9-5 18-5 25 0 12 5 24 16 24s16-12 16-24c0-7-1-16-5-25-3-6-8-6-8-6" />
              <path d="M40 33c0 0-2 2-2 7 0 10 4 18 10 18s10-8 10-18c0-5-2-7-2-7" />
            </g>
          </svg>

          <div class="progress-ring" aria-hidden="true" style="position:absolute;inset:8px;pointer-events:none">
            <svg width="214" height="214" viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="44" stroke="rgba(255,255,255,0.16)" stroke-width="6" fill="none"></circle>
              <circle class="ring" cx="50" cy="50" r="44" stroke="#fff" stroke-width="6" stroke-dasharray="276.46" stroke-dashoffset="276.46" fill="none"></circle>
            </svg>
          </div>

          <div class="count">15s</div>
        </div>
        <div class="name" id="name-youssef">—</div>
        <div class="status" id="status-youssef">يوسف — لم تضغط بعد</div>
      </div>

      <div class="finger-card">
        <div class="finger" tabindex="0" role="button" aria-pressed="false" data-person="rawan" aria-label="بصمة روان">
          <!-- fingerprint icon (different color) -->
          <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <g fill="none" stroke="#8c2c79" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <path d="M50 20c0 0-8 0-12 8-5 11-6 22-6 30 0 14 6 28 20 28s20-14 20-28c0-8-1-19-6-30-4-8-12-8-12-8" />
              <path d="M45 18c0 0-5 0-8 6-4 9-5 18-5 25 0 12 5 24 16 24s16-12 16-24c0-7-1-16-5-25-3-6-8-6-8-6" />
              <path d="M40 33c0 0-2 2-2 7 0 10 4 18 10 18s10-8 10-18c0-5-2-7-2-7" />
            </g>
          </svg>
          <div class="progress-ring" aria-hidden="true" style="position:absolute;inset:8px;pointer-events:none">
            <svg width="214" height="214" viewBox="0 0 100 100">
              <circle cx="50" cy="50" r="44" stroke="rgba(255,255,255,0.16)" stroke-width="6" fill="none"></circle>
              <circle class="ring" cx="50" cy="50" r="44" stroke="#fff" stroke-width="6" stroke-dasharray="276.46" stroke-dashoffset="276.46" fill="none"></circle>
            </svg>
          </div>
          <div class="count">15s</div>
        </div>
        <div class="name" id="name-rawan">—</div>
        <div class="status" id="status-rawan">روان — لم تضغط بعد</div>
      </div>
    </section>

    <section class="scene" id="scene">
      <!-- groom -->
      <div class="character groom" id="groom">
        <svg class="avatar" viewBox="0 0 120 160" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <!-- head -->
          <circle cx="60" cy="30" r="18" fill="#fde7e9" stroke="#b33" stroke-width="1" />
          <!-- suit -->
          <path d="M35 60 L85 60 L75 140 L45 140 Z" fill="#2e2630" />
          <!-- tie -->
          <path d="M59 70 L63 95 L57 95 Z" fill="#b32f52" />
        </svg>
      </div>

      <!-- bride -->
      <div class="character bride" id="bride">
        <svg class="avatar" viewBox="0 0 120 160" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <!-- head -->
          <circle cx="60" cy="30" r="18" fill="#fff4f6" stroke="#8c2c79" stroke-width="1" />
          <!-- dress -->
          <path d="M30 70 C55 110, 65 110, 90 70 L60 140 Z" fill="#fff" stroke="#ffdff0" stroke-width="1" />
          <!-- veil -->
          <path d="M42 18 C55 36, 66 36, 78 18" stroke="#fff" stroke-width="6" fill="none" opacity="0.9" />
        </svg>
      </div>

      <!-- hands connection -->
      <div class="hands" id="hands" aria-hidden="true" style="left:50%;transform:translateX(-50%);">
        <svg width="260" height="120" viewBox="0 0 260 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path id="handpath" d="M10 80 Q130 20 250 80" stroke="#f2c8d5" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round" opacity="0.0" />
        </svg>
      </div>

      <div class="banner" id="banner" role="status">
        <div>✨</div>
        <div><strong id="bannerText">يوسف ❤️ روان — تم الزواج الأبدي</strong></div>
      </div>

      <div class="hearts" id="hearts"></div>

    </section>

    <div class="controls" id="controls">
      <button class="primary" id="downloadBtn" style="display:none">حفظ لحظة (تحميل شهادة PNG)</button>
      <button id="resetBtn" style="display:none">إعادة</button>
    </div>

    <p class="small">ملاحظة: لما تضغط وتكمل الـ15 ثانية، البصمة بتتسجل محليًا في المتصفح علشان تختار تبعت الملف بنفسك — مفيش حاجة بتتحمّل على الإنترنت.</p>
  </main>

  <script>
    (function(){
      const DURATION = (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--press-sec')) || 15) * 1000;
      const fingers = document.querySelectorAll('.finger');
      const state = { youssef:false, rawan:false };
      const nameEls = { youssef:document.getElementById('name-youssef'), rawan:document.getElementById('name-rawan') };
      const statusEls = { youssef:document.getElementById('status-youssef'), rawan:document.getElementById('status-rawan') };
      const ringRadius = 44; const circumference = 2 * Math.PI * ringRadius;

      function setRing(circle,progress){
        const offset = circumference * (1 - progress);
        circle.style.strokeDashoffset = offset;
      }

      function createFloatHeart(x,y,size=22,delay=0){
        const h = document.createElement('div');
        h.className='heart'; h.style.left = x + 'px'; h.style.top = y + 'px'; h.style.fontSize = size + 'px'; h.style.setProperty('--tx',(Math.random()*200-100)+'px');
        h.textContent = '💖';
        document.getElementById('hearts').appendChild(h);
        setTimeout(()=> h.remove(), 2600 + delay);
      }

      function burstHearts(centerX,centerY,count=22){
        for(let i=0;i<count;i++){
          setTimeout(()=> createFloatHeart(centerX + (Math.random()*120 - 60), centerY + (Math.random()*40 - 20), 12 + Math.random()*22), i*80);
        }
      }

      fingers.forEach(fp=>{
        const person = fp.dataset.person;
        const ring = fp.querySelector('.ring');
        const countdown = fp.querySelector('.count');
        let start = 0; let raf=0; let pressing=false;

        function update(){
          const now = performance.now();
          const elapsed = now - start;
          const progress = Math.min(elapsed / DURATION, 1);
          const remaining = Math.ceil((DURATION - elapsed)/1000);
          countdown.textContent = remaining > 0 ? remaining + 's' : '0s';
          setRing(ring, progress);
          if(progress >= 1){
            cancelAnimationFrame(raf);
            finish();
            return;
          }
          raf = requestAnimationFrame(update);
        }

        function finish(){
          pressing = false;
          fp.classList.remove('pressing');
          fp.setAttribute('aria-pressed','true');
          nameEls[person].textContent = (person === 'youssef' ? 'يوسف' : 'روان');
          statusEls[person].textContent = (person === 'youssef' ? 'يوسف — تم التوثيق' : 'روان — تم التوثيق');
          state[person] = true;
          fp.style.pointerEvents = 'none';
          countdown.textContent = 'تم';
          // small heart burst near fingerprint
          const rect = fp.getBoundingClientRect();
          burstHearts(rect.left + rect.width/2, rect.top + rect.height/2, 8);
          if(state.youssef && state.rawan) startRomanceSequence();
        }

        function canceled(){
          pressing=false; fp.classList.remove('pressing'); if(raf) cancelAnimationFrame(raf);
          setRing(ring,0); countdown.textContent = (DURATION/1000) + 's';
          statusEls[person].textContent = (person === 'youssef' ? 'يوسف — انقطع الضغط، حاول تاني' : 'روان — انقطع الضغط، حاول تاني');
          fp.animate([{transform:'translateX(0)'},{transform:'translateX(-8px)'},{transform:'translateX(8px)'},{transform:'translateX(0)'}],{duration:420,easing:'ease-out'});
        }

        function startPress(e){
          if(fp.style.pointerEvents === 'none') return; if(pressing) return;
          e.preventDefault(); pressing=true; fp.classList.add('pressing'); start = performance.now(); setRing(ring,0); countdown.textContent = (DURATION/1000)+'s'; raf = requestAnimationFrame(update);
        }
        function endPress(e){ if(!pressing) return; const now=performance.now(); const elapsed = now - start; if(elapsed >= DURATION){ /* already finished in update() */ } else { canceled(); } }

        // mouse
        fp.addEventListener('mousedown', startPress);
        window.addEventListener('mouseup', endPress);
        // touch
        fp.addEventListener('touchstart', startPress, {passive:false});
        window.addEventListener('touchend', endPress);
        // keyboard
        fp.addEventListener('keydown', function(evt){ if(evt.key === ' ' || evt.key === 'Enter'){ if(evt.repeat) return; startPress(evt); }});
        fp.addEventListener('keyup', function(evt){ if(evt.key === ' ' || evt.key === 'Enter'){ endPress(evt); }});
      });

      // romance sequence
      const groomEl = document.getElementById('groom');
      const brideEl = document.getElementById('bride');
      const handsEl = document.getElementById('hands');
      const banner = document.getElementById('banner');
      const downloadBtn = document.getElementById('downloadBtn');
      const resetBtn = document.getElementById('resetBtn');

      function startRomanceSequence(){
        // step 1: characters enter
        groomEl.style.transform = 'translateX(320px)'; groomEl.classList.add('show');
        brideEl.style.transform = 'translateX(-320px)'; brideEl.classList.add('show');

        setTimeout(()=>{
          // step 2: hands appear and connect
          handsEl.classList.add('show');
          const path = document.getElementById('handpath');
          path.style.opacity = '1';
          path.style.stroke = '#ff9fb3';
          path.style.transition = 'stroke-dashoffset 900ms ease, opacity 400ms ease';
          // animate tiny wave by toggling stroke-dasharray
          path.style.strokeDasharray = '400'; path.style.strokeDashoffset = '400';
          setTimeout(()=>{ path.style.strokeDashoffset = '0'; },60);

          // create a slow coupling of hands (visual)
        }, 900);

        setTimeout(()=>{
          // hearts flutter
          const rect = document.querySelector('.scene').getBoundingClientRect();
          burstHearts(rect.width/2 - 80, rect.height/2 + 60, 30);
        }, 1700);

        setTimeout(()=>{
          // show banner and controls
          banner.classList.add('show'); banner.classList.add('appear');
          downloadBtn.style.display = 'inline-block'; resetBtn.style.display = 'inline-block';
        }, 2600);
      }

      // generate a PNG certificate
      function downloadCertificate(){
        const canvas = document.createElement('canvas');
        const w = 1200, h = 700; canvas.width = w; canvas.height = h; const ctx = canvas.getContext('2d');
        // background gradient
        const g = ctx.createLinearGradient(0,0,w,h); g.addColorStop(0,'#fff7f8'); g.addColorStop(0.5,'#ffdfe6'); g.addColorStop(1,'#ffb7d0'); ctx.fillStyle = g; ctx.fillRect(0,0,w,h);
        // title
        ctx.fillStyle = '#5a2230'; ctx.font = 'bold 42px Arial'; ctx.textAlign = 'center'; ctx.fillText('شهادة زواج — يوسف & روان', w/2, 90);
        // date
        const date = new Date(); const dateStr = date.toLocaleDateString('ar-EG', {year:'numeric',month:'long',day:'numeric'});
        ctx.font = '18px Arial'; ctx.fillStyle = '#6b3442'; ctx.fillText('بتاريخ: ' + dateStr, w/2, 130);

        // draw simple groom
        // groom head
        ctx.fillStyle = '#fde7e9'; ctx.beginPath(); ctx.arc(w*0.3, 300, 48, 0, Math.PI*2); ctx.fill(); ctx.strokeStyle='#b33'; ctx.lineWidth=2; ctx.stroke();
        // groom suit
        ctx.fillStyle = '#2e2630'; ctx.beginPath(); ctx.moveTo(w*0.3-60,380); ctx.lineTo(w*0.3+60,380); ctx.lineTo(w*0.3+30,520); ctx.lineTo(w*0.3-30,520); ctx.closePath(); ctx.fill();

        // bride
        ctx.fillStyle = '#fff4f6'; ctx.beginPath(); ctx.arc(w*0.7,300,48,0,Math.PI*2); ctx.fill(); ctx.strokeStyle='#8c2c79'; ctx.lineWidth=2; ctx.stroke();
        ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.moveTo(w*0.7-60,380); ctx.bezierCurveTo(w*0.7-20,460,w*0.7+20,460,w*0.7+60,380); ctx.lineTo(w*0.7,520); ctx.closePath(); ctx.fill();

        // hands joining (simple)
        ctx.strokeStyle='#f2b6c4'; ctx.lineWidth=18; ctx.lineCap='round'; ctx.beginPath(); ctx.moveTo(w*0.3+40,370); ctx.quadraticCurveTo(w/2,410,w*0.7-40,370); ctx.stroke();

        // big text
        ctx.fillStyle = '#b42f58'; ctx.font = 'bold 36px Arial'; ctx.fillText('✨ تم الزواج الأبدي ✨', w/2, 600);
        ctx.fillStyle = '#3e2028'; ctx.font = '20px Arial'; ctx.fillText('يوسف ❤️ روان', w/2, 640);

        // download
        const data = canvas.toDataURL('image/png');
        const a = document.createElement('a'); a.href = data; a.download = 'Shahadat_Zawag_Youssef_Rawan.png'; document.body.appendChild(a); a.click(); a.remove();
      }

      downloadBtn.addEventListener('click', downloadCertificate);

      // reset
      function resetAll(){
        // reset state
        state.youssef=false; state.rawan=false;
        Object.keys(nameEls).forEach(k=> nameEls[k].textContent='—');
        statusEls.youssef.textContent='يوسف — لم تضغط بعد'; statusEls.rawan.textContent='روان — لم تضغط بعد';
        document.querySelectorAll('.finger').forEach(fp=>{ fp.style.pointerEvents=''; fp.setAttribute('aria-pressed','false'); const r = fp.querySelector('.ring'); r.style.strokeDashoffset = circumference; fp.querySelector('.count').textContent = (DURATION/1000) + 's'; });
        // hide scene
        groomEl.classList.remove('show'); brideEl.classList.remove('show'); groomEl.style.transform='translateX(0)'; brideEl.style.transform='translateX(0)'; handsEl.classList.remove('show'); document.getElementById('banner').classList.remove('show'); document.getElementById('hearts').innerHTML='';
        downloadBtn.style.display='none'; resetBtn.style.display='none';
      }
      resetBtn.addEventListener('click', resetAll);

      // init rings
      document.querySelectorAll('.ring').forEach(r=>{ r.style.strokeDasharray = circumference; r.style.strokeDashoffset = circumference; });

      // helpful: if one pressed already, the other can still press

    })();
  </script>
</body>
</html>
